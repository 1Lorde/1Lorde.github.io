{"version":3,"sources":["../node_modules/@coreui/icons/js/free/cil-asterisk.js","components/NewPassword.js","views/pages/reset_password/ResetPassword.js","api/requestHeaders.js","helpers/notifications.js","api/api_auth.js","../node_modules/@coreui/icons/js/free/cil-phone.js"],"names":["cilAsterisk","NewPassword","params","newPassword","setNewPassword","useState","confirmNewPassword","setConfirmNewPassword","history","useHistory","userDispatch","useContext","UserContext","validated","setValidated","noValidate","className","htmlFor","type","id","required","onChange","e","target","value","invalid","color","onClick","event","currentTarget","checkValidity","preventDefault","stopPropagation","resetPassword","userId","token","then","data","store","addNotification","info","message","temp_token","auth_id","push","catch","response","console","log","danger","ResetPassword","wa_number","setNumber","ktp_id","setKtp","isValid","setIsValid","setUserId","setToken","md","onSubmit","form","forgotPassword","ok","url_link","split","icon","cilPhone","placeholder","pattern","createUUID","replace","c","crypto","getRandomValues","Uint8Array","toString","authHeader","isPermanentTokenExist","Authorization","localStorage","getItem","apiHeader","success","title","insert","container","animationIn","animationOut","dismiss","duration","API_URL","login","waNumber","password","axios","post","headers","reason","loginOtp","otp","access_token","setItem","changePassword","oldPassword","old_password","new_password","changePasswordOtp","ktpId","user_id","resetPasswordOtp","authId"],"mappings":"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","file":"static/js/40.ce7a494f.chunk.js","sourcesContent":["export const cilAsterisk = [\"512 512\",\"<polygon fill='var(--ci-primary-color, currentColor)' points='286.903 256 416 177.877 416 141.115 415.717 140.646 272 227.617 272 72 240 72 240 227.617 96.283 140.646 96 141.115 96 177.877 225.097 256 96 334.123 96 370.885 96.283 371.354 240 284.383 240 440 272 440 272 284.383 415.717 371.354 416 370.885 416 334.123 286.903 256' class='ci-primary'/>\"]","import React, { useContext, useState } from 'react'\nimport { CButton, CForm, CFormFeedback, CFormInput, CFormLabel } from '@coreui/react'\nimport { store } from 'react-notifications-component'\nimport { useHistory } from 'react-router-dom'\nimport { UserContext } from '../helpers/user'\nimport { danger, info } from '../helpers/notifications'\nimport { resetPassword } from '../api/api_auth'\n\nconst NewPassword = (params) => {\n  const [newPassword, setNewPassword] = useState('')\n  const [confirmNewPassword, setConfirmNewPassword] = useState('')\n\n  let history = useHistory()\n  const { userDispatch } = useContext(UserContext)\n\n  const [validated, setValidated] = useState(false)\n  const handleSubmit = (event) => {\n    const form = event.currentTarget\n    if (form.checkValidity() === false) {\n      event.preventDefault()\n      event.stopPropagation()\n    }\n\n    if (newPassword !== confirmNewPassword) {\n      store.addNotification(danger('Check confirmation field'))\n      return\n    }\n\n    setValidated(true)\n\n    resetPassword(params.userId, params.token, newPassword)\n      .then((data) => {\n        store.addNotification(info(data.message))\n        userDispatch({ type: 'request_reset', temp_token: data.auth_id })\n        history.push('/input_otp')\n      })\n      .catch((e) => {\n        let data = e.response.data\n        console.log(data)\n        store.addNotification(danger(data.message))\n      })\n  }\n\n  return (\n    <CForm noValidate validated={validated}>\n      <h2>Reset password</h2>\n      <br />\n      <div className=\"mb-3\">\n        <CFormLabel htmlFor=\"new_pass\">New Password</CFormLabel>\n        <CFormInput\n          type=\"password\"\n          id=\"new_pass\"\n          required\n          onChange={(e) => setNewPassword(e.target.value)}\n        />\n        <CFormFeedback invalid>Please provide new password.</CFormFeedback>\n      </div>\n      <div className=\"mb-3\">\n        <CFormLabel htmlFor=\"confirm_new_pass\">Confirm New Password</CFormLabel>\n        <CFormInput\n          type=\"password\"\n          id=\"confirm_new_pass\"\n          required\n          onChange={(e) => setConfirmNewPassword(e.target.value)}\n        />\n        <CFormFeedback invalid>Please confirm new password.</CFormFeedback>\n      </div>\n      <div className=\"d-flex justify-content-end\">\n        <CButton color=\"primary\" onClick={handleSubmit}>\n          Save\n        </CButton>\n      </div>\n    </CForm>\n  )\n}\n\nexport default NewPassword\n","import React, { useState } from 'react'\nimport {\n  CButton,\n  CCard,\n  CCardBody,\n  CCol,\n  CContainer,\n  CForm,\n  CFormFeedback,\n  CFormInput,\n  CInputGroup,\n  CInputGroupText,\n  CRow,\n} from '@coreui/react'\nimport CIcon from '@coreui/icons-react'\nimport { cilAsterisk, cilPhone } from '@coreui/icons'\nimport { store } from 'react-notifications-component'\nimport { danger, info } from '../../../helpers/notifications'\nimport NewPassword from '../../../components/NewPassword'\nimport { forgotPassword } from '../../../api/api_auth'\n\nconst ResetPassword = () => {\n  const [wa_number, setNumber] = useState('')\n  const [ktp_id, setKtp] = useState('')\n  const [isValid, setIsValid] = useState(false)\n  const [userId, setUserId] = useState('')\n  const [token, setToken] = useState('')\n  const [validated, setValidated] = useState(false)\n\n  function handleReset(event) {\n    event.preventDefault()\n\n    const form = event.currentTarget\n    if (form.checkValidity() === false) {\n      event.preventDefault()\n      event.stopPropagation()\n    }\n    setValidated(true)\n\n    if (form.checkValidity()) {\n      forgotPassword(wa_number, ktp_id).then((data) => {\n        if (data.ok) {\n          store.addNotification(info(data.message))\n          setUserId(data.url_link.split('/')[5])\n          setToken(data.url_link.split('/')[6])\n          setIsValid(true)\n        } else {\n          store.addNotification(danger(data.message))\n        }\n      })\n    }\n  }\n\n  return (\n    <div className=\"bg-light min-vh-100 d-flex flex-row align-items-center\">\n      <CContainer>\n        <CRow className=\"justify-content-center\">\n          <CCol md={5}>\n            <CCard className=\"p-4\">\n              <CCardBody>\n                {isValid ? (\n                  <NewPassword userId={userId} token={token} />\n                ) : (\n                  <CForm noValidate validated={validated} onSubmit={handleReset}>\n                    <h2>Reset password</h2>\n                    <br />\n                    <CInputGroup className=\"mb-3\">\n                      <CInputGroupText>\n                        <CIcon icon={cilPhone} />\n                      </CInputGroupText>\n                      <CFormInput\n                        placeholder=\"WhatsApp number\"\n                        type=\"tel\"\n                        pattern=\"^\\+62[0-9]{9,15}$\"\n                        required\n                        value={wa_number}\n                        onChange={(e) => setNumber(e.target.value)}\n                      />\n                      <CFormFeedback invalid>Please provide a valid phone number.</CFormFeedback>\n                    </CInputGroup>\n                    <CInputGroup className=\"mb-4\">\n                      <CInputGroupText>\n                        <CIcon icon={cilAsterisk} />\n                      </CInputGroupText>\n                      <CFormInput\n                        placeholder=\"KTP number\"\n                        required\n                        pattern=\"^[0-9]{16}$\"\n                        value={ktp_id}\n                        onChange={(e) => setKtp(e.target.value)}\n                      />\n                      <CFormFeedback invalid>Please provide a valid KTP number.</CFormFeedback>\n                    </CInputGroup>\n                    <CRow>\n                      <CCol className=\"d-flex justify-content-end\">\n                        <CButton color=\"primary\" className=\"px-4\" type=\"submit\">\n                          Submit\n                        </CButton>\n                      </CCol>\n                    </CRow>\n                  </CForm>\n                )}\n              </CCardBody>\n            </CCard>\n          </CCol>\n        </CRow>\n      </CContainer>\n    </div>\n  )\n}\n\nexport default ResetPassword\n","import { isPermanentTokenExist } from '../helpers/user'\n\nfunction createUUID() {\n  return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, (c) =>\n    (c ^ (crypto.getRandomValues(new Uint8Array(1))[0] & (15 >> (c / 4)))).toString(16),\n  )\n}\n\nexport function authHeader() {\n  if (isPermanentTokenExist()) {\n    const token = localStorage.getItem('token')\n    return {\n      Authorization: 'Bearer ' + token,\n      'Ekoop-Api-Key': '4a6e486c-3167-4112-97e7-5aa690042613',\n      'X-Request-Id': createUUID(),\n    }\n  } else {\n    return {}\n  }\n}\n\nexport function apiHeader() {\n  return {\n    'Ekoop-Api-Key': '4a6e486c-3167-4112-97e7-5aa690042613',\n    'X-Request-Id': createUUID(),\n  }\n}\n","export function success(message) {\n  return {\n    title: 'Success',\n    message: message,\n    type: 'success',\n    insert: 'bottom',\n    container: 'bottom-right',\n    animationIn: ['animate__animated', 'animate__fadeIn'],\n    animationOut: ['animate__animated', 'animate__fadeOut'],\n    dismiss: {\n      duration: 5000,\n    },\n  }\n}\n\nexport function danger(message) {\n  return {\n    title: 'Error',\n    message: message,\n    type: 'danger',\n    insert: 'bottom',\n    container: 'bottom-right',\n    animationIn: ['animate__animated', 'animate__fadeIn'],\n    animationOut: ['animate__animated', 'animate__fadeOut'],\n    dismiss: {\n      duration: 5000,\n    },\n  }\n}\n\nexport function info(message) {\n  return {\n    title: 'Info',\n    message: message,\n    type: 'info',\n    insert: 'bottom',\n    container: 'bottom-right',\n    animationIn: ['animate__animated', 'animate__fadeIn'],\n    animationOut: ['animate__animated', 'animate__fadeOut'],\n    dismiss: {\n      duration: 5000,\n    },\n  }\n}\n\nexport function warning(message) {\n  return {\n    title: 'Warning',\n    message: message,\n    type: 'warning',\n    insert: 'bottom',\n    container: 'bottom-right',\n    animationIn: ['animate__animated', 'animate__fadeIn'],\n    animationOut: ['animate__animated', 'animate__fadeOut'],\n    dismiss: {\n      duration: 5000,\n    },\n  }\n}\n","import axios from 'axios'\nimport { apiHeader, authHeader } from './requestHeaders'\n\nconst API_URL = 'https://api.ekoop.id/v01'\n\nexport function login(waNumber, password) {\n  return axios\n    .post(\n      API_URL + '/auth/auth/login/password',\n      {\n        wa_number: waNumber,\n        password: password,\n      },\n      {\n        headers: apiHeader(),\n      },\n    )\n    .then((response) => {\n      return response.data\n    })\n    .catch((reason) => {\n      return reason.response.data\n    })\n}\n\nexport function loginOtp(auth_id, otp) {\n  return axios\n    .post(\n      API_URL + '/auth/auth/login/otp',\n      {\n        auth_id: auth_id,\n        otp: otp,\n      },\n      {\n        headers: apiHeader(),\n      },\n    )\n    .then((response) => {\n      if (response.data.access_token) {\n        localStorage.setItem('token', response.data.access_token)\n      }\n      return response.data\n    })\n}\n\nexport function changePassword(oldPassword, newPassword) {\n  return axios\n    .post(\n      API_URL + '/auth/profile/change_password',\n      {\n        old_password: oldPassword,\n        new_password: newPassword,\n      },\n      { headers: authHeader() },\n    )\n    .then((response) => {\n      console.log(response.data)\n      return response.data\n    })\n}\n\nexport function changePasswordOtp(otp) {\n  return axios\n    .post(\n      API_URL + '/auth/profile/change_password/otp',\n      {\n        otp: otp,\n      },\n      {\n        headers: authHeader(),\n      },\n    )\n    .then((response) => {\n      console.log(response)\n      return response.data\n    })\n}\n\nexport function forgotPassword(waNumber, ktpId) {\n  return axios\n    .post(\n      API_URL + '/auth/auth/forgot_password',\n      {\n        wa_number: waNumber,\n        ktp_id: ktpId,\n      },\n      {\n        headers: apiHeader(),\n      },\n    )\n    .then((response) => {\n      return response.data\n    })\n    .catch((reason) => {\n      return reason.response.data\n    })\n}\n\nexport function resetPassword(userId, token, newPassword) {\n  console.log(userId)\n  return axios\n    .post(\n      API_URL + '/auth/auth/reset_password',\n      {\n        user_id: userId,\n        token: token,\n        new_password: newPassword,\n      },\n      {\n        headers: apiHeader(),\n      },\n    )\n    .then((response) => {\n      return response.data\n    })\n    .catch((reason) => {\n      return reason.response.data\n    })\n}\n\nexport function resetPasswordOtp(authId, otp) {\n  return axios\n    .post(\n      API_URL + '/auth/auth/reset_password_otp',\n      {\n        auth_id: authId,\n        otp: otp,\n      },\n      {\n        headers: apiHeader(),\n      },\n    )\n    .then((response) => {\n      return response.data\n    })\n    .catch((reason) => {\n      return reason.response.data\n    })\n}\n","export const cilPhone = [\"512 512\",\"<path fill='var(--ci-primary-color, currentColor)' d='M449.366,89.648l-.685-.428L362.088,46.559,268.625,171.176l43,57.337a88.529,88.529,0,0,1-83.115,83.114l-57.336-43L46.558,362.088l42.306,85.869.356.725.429.684a25.085,25.085,0,0,0,21.393,11.857h22.344A327.836,327.836,0,0,0,461.222,133.386V111.041A25.084,25.084,0,0,0,449.366,89.648Zm-20.144,43.738c0,163.125-132.712,295.837-295.836,295.837h-18.08L87,371.76l84.18-63.135,46.867,35.149h5.333a120.535,120.535,0,0,0,120.4-120.4v-5.333l-35.149-46.866L371.759,87l57.463,28.311Z' class='ci-primary'/>\"]"],"sourceRoot":""}