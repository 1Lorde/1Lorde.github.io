(this.webpackJsonpekoop=this.webpackJsonpekoop||[]).push([[25],{1519:function(e,t,s){"use strict";s.r(t);var c=s(0),n=(s(452),s(401)),a=s(57),o=s(12),i=s(374),r=s(118),d=s(117),l=s(355),u=s(38),j=s(7);t.default=()=>{const{userState:e}=Object(c.useContext)(u.a),t=Object(o.g)();let{uid:s}=Object(o.i)();const[b,m]=Object(c.useState)(),[h,p]=Object(c.useState)(),[O,f]=Object(c.useState)(!1),[x,k]=Object(c.useState)(""),[g,y]=Object(c.useState)(!1);return Object(c.useEffect)((()=>{p(!1),y(!1),Object(i.e)(s).then((e=>{m(e.data),p(!0),f(!1)}))}),[O]),h?Object(j.jsxs)(a.o,{children:[Object(j.jsxs)(a.g,{className:"mb-5",color:"info",style:{backgroundColor:"white"},children:[Object(j.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(j.jsxs)("span",{children:["Created:"," ",new Date(b.history[0].date).toLocaleString("en-US",{weekday:"short",day:"numeric",year:"numeric",month:"long",hour:"numeric",minute:"numeric",second:"numeric"})]}),Object(j.jsxs)("span",{children:["Ticket ID #",b.uid," ",function(e){switch(e){case 0:return Object(j.jsx)(a.b,{className:"mt-1",color:"success",shape:"rounded-pill",children:"New"});case 1:return Object(j.jsx)(a.b,{className:"mt-1",color:"danger",shape:"rounded-pill",children:"Open"});case 2:return Object(j.jsx)(a.b,{className:"mt-1",color:"info",shape:"rounded-pill",children:"Pending"});case 3:return Object(j.jsx)(a.b,{className:"mt-1",color:"secondary",shape:"rounded-pill",children:"Closed"});default:return Object(j.jsx)(a.b,{className:"mt-1",color:"dark",shape:"rounded-pill",children:"unknown"})}}(b.status)]})]}),Object(j.jsx)("hr",{}),Object(j.jsxs)("div",{className:"d-flex justify-content-start",children:[Object(j.jsx)("h5",{children:"Title:"}),Object(j.jsx)("span",{className:"ms-3",children:b.subject})]})]}),Object(j.jsxs)("div",{style:{overflowY:"scroll",maxHeight:"40vh"},children:[b.history.map(((e,t)=>Object(j.jsx)(n.SystemMessage,{text:e.description+" by "+e.owner.fullname},t))),Object(j.jsx)(n.MessageList,{className:"message-list",lockable:!0,toBottomHeight:"100%",dataSource:b.comments.map(((t,s)=>({position:t.owner.fullname===e.company.contact.dir_name?"right":"left",type:"text",text:Object(j.jsx)("div",{className:"mb-1",dangerouslySetInnerHTML:{__html:t.text}}),date:new Date})))})]}),Object(j.jsxs)(a.v,{noValidate:!0,validated:g,onSubmit:function(e){e.preventDefault();const t=e.currentTarget;!1===t.checkValidity()&&e.stopPropagation(),y(!0),t.checkValidity()&&Object(i.b)(b._id,x).then((e=>{e.ok?(f(!0),d.store.addNotification(Object(l.c)("Comment sent successfully."))):e.message?(console.log(e),d.store.addNotification(Object(l.a)(e.message))):(console.log(e),d.store.addNotification(Object(l.a)(e.error)))}))},children:[Object(j.jsxs)("div",{className:"m-4",children:[Object(j.jsx)(a.z,{htmlFor:"title",children:"Comment"}),Object(j.jsx)(a.y,{type:"text",id:"comment",disabled:3===b.status,required:!0,onChange:e=>{k(e.target.value)}}),Object(j.jsx)(a.x,{invalid:!0,children:"Please provide a comment."})]}),Object(j.jsxs)("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:[Object(j.jsx)(a.e,{color:"primary",className:"me-md-2",variant:"outline",onClick:function(){Object(i.a)(b._id).then((e=>{e.ok?(d.store.addNotification(Object(l.c)("Ticket closed")),t.push("/support/tickets")):d.store.addNotification(Object(l.a)("Error"))}))},disabled:3===b.status,children:"Close Ticket"}),Object(j.jsx)(a.e,{type:"submit",color:"dark",className:"me-md-2",variant:"outline",disabled:3===b.status,children:"New Comment"})]})]})]}):Object(r.a)()}},374:function(e,t,s){"use strict";s.d(t,"f",(function(){return i})),s.d(t,"e",(function(){return r})),s.d(t,"a",(function(){return d})),s.d(t,"c",(function(){return l})),s.d(t,"b",(function(){return u})),s.d(t,"d",(function(){return j}));var c=s(353),n=s.n(c),a=s(352);const o="https://api.ekoop.id/v01";function i(e,t){return n.a.get(o+"/tiket/tickets?skip="+e+"&search="+t,{headers:Object(a.b)()}).then((e=>e.data)).catch((e=>{console.log(e)}))}function r(e){return n.a.get(o+"/tiket/tickets/"+e,{headers:Object(a.b)()}).then((e=>e.data)).catch((e=>{console.log(e)}))}function d(e){return n.a.put(o+"/tiket/tickets/"+e,{status:3},{headers:Object(a.b)()}).then((e=>e.data)).catch((e=>{console.log(e)}))}function l(e){return n.a.post(o+"/tiket/tickets",{subject:e.title,description:e.description,type:"Issue",priority:"Normal"},{headers:Object(a.b)()}).then((e=>e.data)).catch((e=>{console.log(e.response.data)}))}function u(e,t){return n.a.post(o+"/tiket/tickets/comment",{ticket_id:e,text:t},{headers:Object(a.b)()}).then((e=>e.data)).catch((e=>{console.log(e.response.data)}))}function j(e,t,s){return n.a.post(o+"/tiket/users",{ekoop_user_id:e,username:t.replace("+",""),password:t.replace("+","")+"123!",email:t.replace("+","")+"@example.com",fullname:s},{headers:Object(a.b)()}).then((e=>e.data)).catch((e=>{console.log(e.response.data)}))}}}]);
//# sourceMappingURL=25.1040bce4.chunk.js.map