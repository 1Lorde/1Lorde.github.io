(this.webpackJsonpekoop=this.webpackJsonpekoop||[]).push([[17],{1517:function(e,t,c){"use strict";c.r(t);var a=c(0),r=c.n(a),n=c(57),s=c(12),o=c(374),i=c(362),l=c(38),d=c(70),u=c(117),j=c(355),b=c(7);t.default=()=>{const e=Object(s.g)(),{userState:t,userDispatch:c}=Object(a.useContext)(l.a),[p,h]=Object(a.useState)(!1),[O,g]=Object(a.useState)([]),[m,x]=Object(a.useState)(""),[f,k]=Object(a.useState)(1),y=Object(a.useRef)(0);function v(e){switch(e){case 0:return Object(b.jsx)(n.b,{className:"mt-1",color:"success",shape:"rounded-pill",children:"New"});case 1:return Object(b.jsx)(n.b,{className:"mt-1",color:"danger",shape:"rounded-pill",children:"Open"});case 2:return Object(b.jsx)(n.b,{className:"mt-1",color:"info",shape:"rounded-pill",children:"Pending"});case 3:return Object(b.jsx)(n.b,{className:"mt-1",color:"secondary",shape:"rounded-pill",children:"Closed"});default:return Object(b.jsx)(n.b,{className:"mt-1",color:"dark",shape:"rounded-pill",children:"unknown"})}}const C=Object(a.useCallback)((({skip:c})=>{++y.current===y.current&&(h(!1),Object(o.f)(c,m).then((c=>{if(console.log(c),c){var a;let t=Math.floor(c.pagination.total/c.pagination.limit);c.pagination.total/c.pagination.limit>f&&(t+=1),k(t),g(null===(a=c.data)||void 0===a?void 0:a.map((t=>({id:t.uid,title:t.subject,status:v(t.status),action:Object(b.jsx)(n.e,{color:"dark",size:"sm",onClick:()=>e.push("/support/tickets/"+t.uid),children:"View"})}))))}else[d.c["credit-analyst"],d.c["account-officer"]].includes(d.c[t.user.role])?Object(o.d)(Object(l.d)(),t.company.contact.wa_number,t.company.contact.dir_name).then((e=>{console.log(e),u.store.addNotification(Object(j.b)("Your support account not approved yet. Please try again later"))})):Object(o.d)(t.user.id,t.user.wa_number,t.user.name).then((e=>{console.log(e),u.store.addNotification(Object(j.b)("Your support account not approved yet. Please try again later"))}));h(!0)})))}),[e,m]),P=r.a.useMemo((()=>[{Header:"Ticket ID",accessor:"id"},{Header:"Title",accessor:"title"},{Header:"Status",accessor:"status"},{Header:"Action",accessor:"action"}]),[]);return Object(b.jsxs)(n.o,{children:[Object(b.jsxs)(n.X,{className:"align-items-center",children:[Object(b.jsxs)(n.n,{children:[Object(b.jsx)(n.z,{htmlFor:"searchInput",children:"Search"}),Object(b.jsx)(n.y,{type:"text",id:"searchInput",placeholder:"Enter search query..",onChange:e=>{x(e.target.value)}})]}),Object(b.jsx)(n.n,{className:"d-flex justify-content-end",children:Object(b.jsx)(n.e,{color:"primary",onClick:()=>e.push("/support/tickets/new"),children:"Create New"})})]}),Object(b.jsx)("br",{}),Object(b.jsx)(n.X,{children:Object(b.jsx)(n.h,{children:Object(b.jsx)(n.i,{children:Object(b.jsx)(i.a,{columns:P,data:O,controlledPageCount:f,fetchData:C,hasLoaded:p})})})})]})}},362:function(e,t,c){"use strict";c.d(t,"a",(function(){return l}));var a=c(367),r=c(57),n=c(0),s=c(357);const o=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M256,16C123.452,16,16,123.452,16,256S123.452,496,256,496,496,388.548,496,256,388.548,16,256,16ZM403.078,403.078a207.253,207.253,0,1,1,44.589-66.125A207.332,207.332,0,0,1,403.078,403.078Z' class='ci-primary'/><rect width='40' height='40' x='152' y='200' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='40' height='40' x='320' y='200' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M256,288a88.1,88.1,0,0,0-88,88h32a56,56,0,0,1,112,0h32A88.1,88.1,0,0,0,256,288Z' class='ci-primary'/>"];var i=c(7);function l({columns:e,data:t,controlledPageCount:c,fetchData:l,hasLoaded:d}){const{getTableProps:u,getTableBodyProps:j,headerGroups:b,prepareRow:p,page:h,canPreviousPage:O,canNextPage:g,pageOptions:m,gotoPage:x,nextPage:f,previousPage:k,state:{pageIndex:y}}=Object(a.useTable)({columns:e,data:t,initialState:{pageIndex:0,pageSize:10},manualPagination:!0,pageCount:c},a.usePagination);return Object(n.useEffect)((()=>{l&&l({skip:10*y})}),[l,y]),d?h.length>0?Object(i.jsxs)(i.Fragment,{children:[Object(i.jsxs)(r.fb,{hover:!0,responsive:!0,style:{minWidth:"45rem"},...u(),children:[Object(i.jsx)(r.ib,{children:b.map(((e,t)=>Object(i.jsx)(r.kb,{...e.getHeaderGroupProps(),children:e.headers.map(((e,t)=>Object(i.jsx)(r.jb,{...e.getHeaderProps(),children:e.render("Header")},t)))},t)))}),Object(i.jsx)(r.gb,{...j(),children:h.map(((e,t)=>(p(e),Object(i.jsx)(r.kb,{...e.getRowProps(),children:e.cells.map(((e,t)=>Object(i.jsx)(r.hb,{...e.getCellProps(),children:e.render("Cell")},t)))},t))))})]}),Object(i.jsxs)(r.o,{className:"d-flex justify-content-end align-items-center",children:[Object(i.jsx)(r.G,{className:"pe-2",children:"Go to page:"}),Object(i.jsx)(r.y,{min:1,max:c,type:"number",defaultValue:y+1,onChange:e=>{const t=e.target.value?Number(e.target.value)-1:0;x(t)},style:{width:"100px"}})]}),Object(i.jsxs)(r.V,{align:"center","aria-label":"Page navigation",children:[Object(i.jsx)(r.W,{"aria-label":"First",onClick:()=>x(0),disabled:!O,children:"<<"}),Object(i.jsx)(r.W,{"aria-label":"Previous",onClick:()=>k(),disabled:!O,children:"<"}),Object(i.jsxs)(r.W,{"aria-label":"Current",style:{pointerEvents:"none"},children:["Page ",Object(i.jsx)("strong",{children:y+1})," of ",Object(i.jsx)("strong",{children:m.length})]}),Object(i.jsx)(r.W,{"aria-label":"Next",onClick:()=>f(),disabled:!g,children:">"}),Object(i.jsx)(r.W,{"aria-label":"Last",onClick:()=>x(c-1),disabled:!g,children:">>"})]})]}):Object(i.jsx)(r.n,{className:"d-flex justify-content-center",children:Object(i.jsxs)(r.G,{children:["Nothing there ",Object(i.jsx)(s.a,{icon:o})," "]})}):Object(i.jsx)(r.n,{className:"d-flex justify-content-center",children:Object(i.jsx)(r.cb,{color:"primary"})})}},374:function(e,t,c){"use strict";c.d(t,"f",(function(){return o})),c.d(t,"e",(function(){return i})),c.d(t,"a",(function(){return l})),c.d(t,"c",(function(){return d})),c.d(t,"b",(function(){return u})),c.d(t,"d",(function(){return j}));var a=c(353),r=c.n(a),n=c(352);const s="https://api.ekoop.id/v01";function o(e,t){return r.a.get(s+"/tiket/tickets?skip="+e+"&search="+t,{headers:Object(n.b)()}).then((e=>e.data)).catch((e=>{console.log(e)}))}function i(e){return r.a.get(s+"/tiket/tickets/"+e,{headers:Object(n.b)()}).then((e=>e.data)).catch((e=>{console.log(e)}))}function l(e){return r.a.put(s+"/tiket/tickets/"+e,{status:3},{headers:Object(n.b)()}).then((e=>e.data)).catch((e=>{console.log(e)}))}function d(e){return r.a.post(s+"/tiket/tickets",{subject:e.title,description:e.description,type:"Issue",priority:"Normal"},{headers:Object(n.b)()}).then((e=>e.data)).catch((e=>{console.log(e.response.data)}))}function u(e,t){return r.a.post(s+"/tiket/tickets/comment",{ticket_id:e,text:t},{headers:Object(n.b)()}).then((e=>e.data)).catch((e=>{console.log(e.response.data)}))}function j(e,t,c){return r.a.post(s+"/tiket/users",{ekoop_user_id:e,username:t.replace("+",""),password:t.replace("+","")+"123!",email:t.replace("+","")+"@example.com",fullname:c},{headers:Object(n.b)()}).then((e=>e.data)).catch((e=>{console.log(e.response.data)}))}}}]);
//# sourceMappingURL=17.f18c244d.chunk.js.map