{"version":3,"sources":["../node_modules/@coreui/icons/js/free/cil-lock-locked.js","views/pages/login/Login.js","api/requestHeaders.js","helpers/notifications.js","api/api_auth.js","../node_modules/@coreui/icons/js/free/cil-phone.js"],"names":["cilLockLocked","Login","wa_number","setNumber","useState","password","setPassword","userDispatch","useContext","UserContext","history","useHistory","validated","setValidated","className","md","noValidate","onSubmit","event","preventDefault","form","currentTarget","checkValidity","stopPropagation","login","then","data","ok","type","temp_token","auth_id","console","log","store","addNotification","info","message","push","danger","icon","cilPhone","pattern","placeholder","required","value","onChange","e","target","invalid","color","to","createUUID","replace","c","crypto","getRandomValues","Uint8Array","toString","authHeader","isPermanentTokenExist","Authorization","localStorage","getItem","apiHeader","success","title","insert","container","animationIn","animationOut","dismiss","duration","API_URL","waNumber","axios","post","headers","response","catch","reason","loginOtp","otp","access_token","setItem","changePassword","oldPassword","newPassword","old_password","new_password","changePasswordOtp","forgotPassword","ktpId","ktp_id","resetPassword","userId","token","user_id","resetPasswordOtp","authId"],"mappings":"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","file":"static/js/38.72430d35.chunk.js","sourcesContent":["export const cilLockLocked = [\"512 512\",\"<path fill='var(--ci-primary-color, currentColor)' d='M384,200V144a128,128,0,0,0-256,0v56H88V328c0,92.635,75.364,168,168,168s168-75.365,168-168V200ZM160,144a96,96,0,0,1,192,0v56H160ZM392,328c0,74.99-61.01,136-136,136s-136-61.01-136-136V232H392Z' class='ci-primary'/>\"]","import React, { useContext, useState } from 'react'\nimport {\n  CButton,\n  CCard,\n  CCardBody,\n  CCol,\n  CContainer,\n  CForm,\n  CFormFeedback,\n  CFormInput,\n  CInputGroup,\n  CInputGroupText,\n  CRow,\n} from '@coreui/react'\nimport CIcon from '@coreui/icons-react'\nimport { cilLockLocked, cilPhone } from '@coreui/icons'\nimport { Link, useHistory } from 'react-router-dom'\nimport { UserContext } from '../../../helpers/user'\nimport { danger, info } from '../../../helpers/notifications'\nimport { store } from 'react-notifications-component'\nimport { login } from '../../../api/api_auth'\n\nconst Login = () => {\n  const [wa_number, setNumber] = useState('')\n  const [password, setPassword] = useState('')\n  const { userDispatch } = useContext(UserContext)\n  const history = useHistory()\n  const [validated, setValidated] = useState(false)\n\n  function handleLogin(event) {\n    event.preventDefault()\n\n    const form = event.currentTarget\n    if (form.checkValidity() === false) {\n      event.stopPropagation()\n    }\n    setValidated(true)\n\n    if (form.checkValidity()) {\n      login(wa_number, password).then((data) => {\n        if (data.ok) {\n          userDispatch({ type: 'request_login', temp_token: data.auth_id })\n          console.log(data)\n          store.addNotification(info(data.message))\n          history.push('/input_otp')\n        } else {\n          store.addNotification(danger(data.message))\n        }\n      })\n    }\n  }\n\n  return (\n    <div className=\"bg-light min-vh-100 d-flex flex-row align-items-center\">\n      <CContainer>\n        <CRow className=\"justify-content-center\">\n          <CCol md={5}>\n            <CCard className=\"p-4\">\n              <CCardBody>\n                <CForm noValidate validated={validated} onSubmit={handleLogin}>\n                  <h1>Login</h1>\n                  <p className=\"text-medium-emphasis\">Sign In to your account</p>\n                  <CInputGroup className=\"mb-3\">\n                    <CInputGroupText>\n                      <CIcon icon={cilPhone} />\n                    </CInputGroupText>\n                    <CFormInput\n                      type=\"tel\"\n                      pattern=\"^\\+62[0-9]{9,15}$\"\n                      placeholder=\"WhatsApp number\"\n                      required\n                      value={wa_number}\n                      onChange={(e) => setNumber(e.target.value)}\n                    />\n                    <CFormFeedback invalid>Please provide a valid phone number.</CFormFeedback>\n                  </CInputGroup>\n                  <CInputGroup className=\"mb-4\">\n                    <CInputGroupText>\n                      <CIcon icon={cilLockLocked} />\n                    </CInputGroupText>\n                    <CFormInput\n                      type=\"password\"\n                      placeholder=\"Password\"\n                      required\n                      value={password}\n                      onChange={(e) => setPassword(e.target.value)}\n                    />\n                    <CFormFeedback invalid>Please provide a password.</CFormFeedback>\n                  </CInputGroup>\n                  <div className=\"d-flex justify-content-start\">\n                    <CButton color=\"primary\" className=\"px-4\" type=\"submit\">\n                      Login\n                    </CButton>\n                  </div>\n                  <div className=\"d-flex justify-content-end\">\n                    <Link to=\"/register\">Client registration</Link>\n                    &nbsp;&nbsp;&nbsp;&nbsp;\n                    <Link to=\"/reset_password\">Forgot password</Link>\n                  </div>\n                </CForm>\n              </CCardBody>\n            </CCard>\n          </CCol>\n        </CRow>\n      </CContainer>\n    </div>\n  )\n}\n\nexport default Login\n","import { isPermanentTokenExist } from '../helpers/user'\n\nfunction createUUID() {\n  return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, (c) =>\n    (c ^ (crypto.getRandomValues(new Uint8Array(1))[0] & (15 >> (c / 4)))).toString(16),\n  )\n}\n\nexport function authHeader() {\n  if (isPermanentTokenExist()) {\n    const token = localStorage.getItem('token')\n    return {\n      Authorization: 'Bearer ' + token,\n      'Ekoop-Api-Key': '4a6e486c-3167-4112-97e7-5aa690042613',\n      'X-Request-Id': createUUID(),\n    }\n  } else {\n    return {}\n  }\n}\n\nexport function apiHeader() {\n  return {\n    'Ekoop-Api-Key': '4a6e486c-3167-4112-97e7-5aa690042613',\n    'X-Request-Id': createUUID(),\n  }\n}\n","export function success(message) {\n  return {\n    title: 'Success',\n    message: message,\n    type: 'success',\n    insert: 'bottom',\n    container: 'bottom-right',\n    animationIn: ['animate__animated', 'animate__fadeIn'],\n    animationOut: ['animate__animated', 'animate__fadeOut'],\n    dismiss: {\n      duration: 5000,\n    },\n  }\n}\n\nexport function danger(message) {\n  return {\n    title: 'Error',\n    message: message,\n    type: 'danger',\n    insert: 'bottom',\n    container: 'bottom-right',\n    animationIn: ['animate__animated', 'animate__fadeIn'],\n    animationOut: ['animate__animated', 'animate__fadeOut'],\n    dismiss: {\n      duration: 5000,\n    },\n  }\n}\n\nexport function info(message) {\n  return {\n    title: 'Info',\n    message: message,\n    type: 'info',\n    insert: 'bottom',\n    container: 'bottom-right',\n    animationIn: ['animate__animated', 'animate__fadeIn'],\n    animationOut: ['animate__animated', 'animate__fadeOut'],\n    dismiss: {\n      duration: 5000,\n    },\n  }\n}\n\nexport function warning(message) {\n  return {\n    title: 'Warning',\n    message: message,\n    type: 'warning',\n    insert: 'bottom',\n    container: 'bottom-right',\n    animationIn: ['animate__animated', 'animate__fadeIn'],\n    animationOut: ['animate__animated', 'animate__fadeOut'],\n    dismiss: {\n      duration: 5000,\n    },\n  }\n}\n","import axios from 'axios'\nimport { apiHeader, authHeader } from './requestHeaders'\n\nconst API_URL = 'https://api.ekoop.id/v01'\n\nexport function login(waNumber, password) {\n  return axios\n    .post(\n      API_URL + '/auth/auth/login/password',\n      {\n        wa_number: waNumber,\n        password: password,\n      },\n      {\n        headers: apiHeader(),\n      },\n    )\n    .then((response) => {\n      return response.data\n    })\n    .catch((reason) => {\n      return reason.response.data\n    })\n}\n\nexport function loginOtp(auth_id, otp) {\n  return axios\n    .post(\n      API_URL + '/auth/auth/login/otp',\n      {\n        auth_id: auth_id,\n        otp: otp,\n      },\n      {\n        headers: apiHeader(),\n      },\n    )\n    .then((response) => {\n      if (response.data.access_token) {\n        localStorage.setItem('token', response.data.access_token)\n      }\n      return response.data\n    })\n}\n\nexport function changePassword(oldPassword, newPassword) {\n  return axios\n    .post(\n      API_URL + '/auth/profile/change_password',\n      {\n        old_password: oldPassword,\n        new_password: newPassword,\n      },\n      { headers: authHeader() },\n    )\n    .then((response) => {\n      console.log(response.data)\n      return response.data\n    })\n}\n\nexport function changePasswordOtp(otp) {\n  return axios\n    .post(\n      API_URL + '/auth/profile/change_password/otp',\n      {\n        otp: otp,\n      },\n      {\n        headers: authHeader(),\n      },\n    )\n    .then((response) => {\n      console.log(response)\n      return response.data\n    })\n}\n\nexport function forgotPassword(waNumber, ktpId) {\n  return axios\n    .post(\n      API_URL + '/auth/auth/forgot_password',\n      {\n        wa_number: waNumber,\n        ktp_id: ktpId,\n      },\n      {\n        headers: apiHeader(),\n      },\n    )\n    .then((response) => {\n      return response.data\n    })\n    .catch((reason) => {\n      return reason.response.data\n    })\n}\n\nexport function resetPassword(userId, token, newPassword) {\n  console.log(userId)\n  return axios\n    .post(\n      API_URL + '/auth/auth/reset_password',\n      {\n        user_id: userId,\n        token: token,\n        new_password: newPassword,\n      },\n      {\n        headers: apiHeader(),\n      },\n    )\n    .then((response) => {\n      return response.data\n    })\n    .catch((reason) => {\n      return reason.response.data\n    })\n}\n\nexport function resetPasswordOtp(authId, otp) {\n  return axios\n    .post(\n      API_URL + '/auth/auth/reset_password_otp',\n      {\n        auth_id: authId,\n        otp: otp,\n      },\n      {\n        headers: apiHeader(),\n      },\n    )\n    .then((response) => {\n      return response.data\n    })\n    .catch((reason) => {\n      return reason.response.data\n    })\n}\n","export const cilPhone = [\"512 512\",\"<path fill='var(--ci-primary-color, currentColor)' d='M449.366,89.648l-.685-.428L362.088,46.559,268.625,171.176l43,57.337a88.529,88.529,0,0,1-83.115,83.114l-57.336-43L46.558,362.088l42.306,85.869.356.725.429.684a25.085,25.085,0,0,0,21.393,11.857h22.344A327.836,327.836,0,0,0,461.222,133.386V111.041A25.084,25.084,0,0,0,449.366,89.648Zm-20.144,43.738c0,163.125-132.712,295.837-295.836,295.837h-18.08L87,371.76l84.18-63.135,46.867,35.149h5.333a120.535,120.535,0,0,0,120.4-120.4v-5.333l-35.149-46.866L371.759,87l57.463,28.311Z' class='ci-primary'/>\"]"],"sourceRoot":""}