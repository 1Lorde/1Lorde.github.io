{"version":3,"sources":["views/products/products_ppob/ProductsPpob.js","helpers/utils.js","api/api_service.js"],"names":["ProductsPpob","history","useHistory","services","setServices","useState","hasLoaded","setHasLoaded","servicesMargin","setServicesMargin","validated","setValidated","searchQuery","setSearchQuery","category","setCategory","active","setActive","marginBy","setMarginBy","useEffect","console","log","getServices","then","data","ok","getServicesMargin","service_margin","className","xl","htmlFor","type","id","placeholder","onChange","e","target","value","noValidate","onSubmit","event","preventDefault","form","currentTarget","checkValidity","stopPropagation","updateServicesMargin","store","addNotification","success","danger","error","defaultValue","margin_by","nominal","max","tryParseInt","size","length","map","service","index","xxl","md","style","width","height","cursor","onClick","push","orientation","src","name","desc","color","shape","Loader","text","parsed","parseInt","isNaN","API_URL","axios","get","headers","authHeader","response","catch","reason","getService","updateService","put"],"mappings":"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","file":"static/js/12.908357ce.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport {\n  CBadge,\n  CButton,\n  CCard,\n  CCardBody,\n  CCardImage,\n  CCardText,\n  CCardTitle,\n  CCol,\n  CContainer,\n  CForm,\n  CFormInput,\n  CFormLabel,\n  CFormSelect,\n  CHeaderText,\n  CRow,\n} from '@coreui/react'\n\nimport { useHistory } from 'react-router-dom'\nimport Loader from '../../../components/Loader'\nimport { getServices, getServicesMargin, updateServicesMargin } from '../../../api/api_service'\nimport { store } from 'react-notifications-component'\nimport { danger, success } from '../../../helpers/notifications'\nimport { tryParseInt } from '../../../helpers/utils'\n\nconst ProductsPpob = () => {\n  const history = useHistory()\n  const [services, setServices] = useState([])\n  const [hasLoaded, setHasLoaded] = useState()\n  const [servicesMargin, setServicesMargin] = useState({})\n  const [validated, setValidated] = useState(false)\n  const [searchQuery, setSearchQuery] = useState('')\n  const [category, setCategory] = useState('')\n  const [active, setActive] = useState('')\n  const [marginBy, setMarginBy] = useState('')\n\n  const handleServicesMarginUpdate = (event) => {\n    event.preventDefault()\n\n    const form = event.currentTarget\n    if (form.checkValidity() === false) {\n      event.preventDefault()\n      event.stopPropagation()\n    }\n    setValidated(true)\n\n    if (form.checkValidity()) {\n      console.log(servicesMargin)\n      updateServicesMargin(servicesMargin).then((data) => {\n        if (data.ok) {\n          console.log(data)\n          store.addNotification(success('Service margin updated successfully.'))\n        } else {\n          console.log(data)\n          store.addNotification(danger(data.error))\n        }\n      })\n    }\n  }\n\n  useEffect(() => {\n    console.log(marginBy)\n    getServices(searchQuery, category, active, marginBy).then((data) => {\n      if (data.ok === true) {\n        console.log(data)\n        setServices(data.services)\n        if (!hasLoaded) {\n          getServicesMargin().then((data) => {\n            if (data.ok === true) {\n              console.log(data)\n              setServicesMargin(data.service_margin)\n              setHasLoaded(true)\n            }\n          })\n        }\n      }\n    })\n  }, [searchQuery, category, active, marginBy])\n\n  return hasLoaded ? (\n    <CContainer>\n      <CRow className=\"align-items-center mb-4\">\n        <CCol xl={4}>\n          <CFormLabel htmlFor=\"searchInput\">Search</CFormLabel>\n          <CFormInput\n            type=\"text\"\n            id=\"searchInput\"\n            placeholder=\"Enter search query..\"\n            onChange={(e) => {\n              setSearchQuery(e.target.value)\n            }}\n          />\n        </CCol>\n        <CCol>\n          <CFormLabel htmlFor=\"categoryInput\">Category</CFormLabel>\n          <CFormSelect\n            id=\"categoryInput\"\n            onChange={(e) => {\n              setCategory(e.target.value)\n            }}\n          >\n            <option value=\"\">All</option>\n            <option value=\"postpaid\">Postpaid</option>\n            <option value=\"prepaid\">Prepaid</option>\n          </CFormSelect>\n        </CCol>\n        <CCol>\n          <CFormLabel htmlFor=\"statusInput\">Status</CFormLabel>\n          <CFormSelect\n            id=\"statusInput\"\n            onChange={(e) => {\n              setActive(e.target.value)\n            }}\n          >\n            <option value=\"\">All</option>\n            <option value={1}>Active</option>\n            <option value={0}>Inactive</option>\n          </CFormSelect>\n        </CCol>\n        <CCol>\n          <CFormLabel htmlFor=\"marginByInput\">Margin By</CFormLabel>\n          <CFormSelect\n            id=\"marginByInput\"\n            onChange={(e) => {\n              setMarginBy(e.target.value)\n            }}\n          >\n            <option value=\"\">All</option>\n            <option value=\"fix_cost\">Fix Cost</option>\n            <option value=\"percent\">Percent</option>\n          </CFormSelect>\n        </CCol>\n      </CRow>\n      <CForm noValidate validated={validated} onSubmit={handleServicesMarginUpdate}>\n        <CRow className=\"align-items-center mb-5\">\n          <CCol xl={3}>\n            <CFormLabel htmlFor=\"margin_by\">Margin By (for all)</CFormLabel>\n            <CFormSelect\n              id=\"margin_by\"\n              defaultValue={servicesMargin.margin_by}\n              onChange={(e) => {\n                setServicesMargin((servicesMargin) => ({\n                  ...servicesMargin,\n                  margin_by: e.target.value,\n                }))\n              }}\n            >\n              <option value=\"fix_cost\">Fix Cost</option>\n              <option value=\"percent\">Percent</option>\n            </CFormSelect>\n          </CCol>\n\n          <CCol xl={3}>\n            <CFormLabel htmlFor=\"nominal\">Nominal</CFormLabel>\n            <CFormInput\n              id=\"nominal\"\n              type=\"number\"\n              defaultValue={servicesMargin.nominal}\n              max={servicesMargin.margin_by === 'percent' ? 100 : 100000}\n              onChange={(e) => {\n                setServicesMargin((servicesMargin) => ({\n                  ...servicesMargin,\n                  nominal: tryParseInt(e.target.value),\n                }))\n              }}\n            />\n          </CCol>\n          <CCol xl={3}>\n            <CButton className=\"mt-4\" size=\"sm\" type=\"submit\">\n              Update margin\n            </CButton>\n          </CCol>\n        </CRow>\n      </CForm>\n\n      <CRow className=\"justify-content-start\">\n        {services.length > 0 ? (\n          services?.map((service, index) => {\n            return (\n              <CCol key={index} xxl={3} md={5} className=\"mb-4\">\n                <CCard\n                  style={{ width: '18rem', height: '100%', cursor: 'pointer' }}\n                  onClick={() => {\n                    history.push('/products/ppob/' + service.id)\n                  }}\n                >\n                  <CCardImage\n                    orientation=\"top\"\n                    src={'https://via.placeholder.com/550x390.png?text=' + service.name}\n                  />\n                  <CCardBody className=\"text-center\">\n                    <CCardTitle>{service.name}</CCardTitle>\n                    <CCardText>{service.desc}</CCardText>\n                    {service.active ? (\n                      <CBadge color=\"success\" shape=\"rounded-pill\">\n                        Active\n                      </CBadge>\n                    ) : (\n                      <CBadge color=\"dark\" shape=\"rounded-pill\">\n                        Inactive\n                      </CBadge>\n                    )}\n                  </CCardBody>\n                </CCard>\n              </CCol>\n            )\n          })\n        ) : (\n          <>\n            <div className=\"d-flex justify-content-center\">\n              <CHeaderText>No PPOB found</CHeaderText>\n            </div>\n          </>\n        )}\n      </CRow>\n    </CContainer>\n  ) : (\n    Loader()\n  )\n}\n\nexport default ProductsPpob\n","export function tryParseInt(text) {\n  const parsed = parseInt(text)\n  if (isNaN(parsed)) {\n    return ''\n  }\n  return parsed\n}\n","import axios from 'axios'\nimport { authHeader } from './requestHeaders'\n\nconst API_URL = 'https://api.ekoop.id/v01'\n\nexport function getServices(searchQuery, category, active, marginBy) {\n  return axios\n    .get(\n      API_URL +\n        '/transaction/services?search=' +\n        searchQuery +\n        '&category=' +\n        category +\n        '&active=' +\n        active +\n        '&margin_by=' +\n        marginBy,\n      { headers: authHeader() },\n    )\n    .then((response) => {\n      return response.data\n    })\n    .catch((reason) => {\n      console.log(reason)\n    })\n}\n\nexport function getService(id) {\n  return axios\n    .get(API_URL + '/transaction/services/' + id, { headers: authHeader() })\n    .then((response) => {\n      return response.data\n    })\n    .catch((reason) => {\n      console.log(reason)\n    })\n}\n\nexport function updateService(id, service) {\n  return axios\n    .put(API_URL + '/transaction/services/' + id, service, {\n      headers: authHeader(),\n    })\n    .then((response) => {\n      return response.data\n    })\n    .catch((reason) => {\n      return reason.response.data\n    })\n}\n\nexport function getServicesMargin() {\n  return axios\n    .get(API_URL + '/transaction/service_margin', {\n      headers: authHeader(),\n    })\n    .then((response) => {\n      return response.data\n    })\n    .catch((reason) => {\n      return reason.response.data\n    })\n}\n\nexport function updateServicesMargin(servicesMargin) {\n  return axios\n    .put(\n      API_URL + '/transaction/service_margin',\n      {\n        margin_by: servicesMargin.margin_by,\n        nominal: servicesMargin.nominal,\n      },\n      {\n        headers: authHeader(),\n      },\n    )\n    .then((response) => {\n      return response.data\n    })\n    .catch((reason) => {\n      return reason.response.data\n    })\n}\n"],"sourceRoot":""}