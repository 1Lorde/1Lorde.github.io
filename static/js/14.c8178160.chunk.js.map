{"version":3,"sources":["views/nasabah/nasabah_list/NasabahList.js","components/Table.js","api/api_nasabah.js"],"names":["NasabahList","history","useHistory","hasLoaded","setHasLoaded","useState","nasabahList","setNasabah","searchQuery","setSearchQuery","status","setStatus","pageCount","setPageCount","fetchIdRef","useRef","fetchData","useCallback","skip","current","getNasabahList","then","data","console","log","pages","Math","floor","pagination","total","limit","map","item","name","number","wa_number","location","address","active","className","color","shape","action","size","onClick","push","id","icon","cilPen","columns","React","useMemo","Header","accessor","htmlFor","type","placeholder","onChange","e","target","value","controlledPageCount","Table","getTableProps","getTableBodyProps","headerGroups","prepareRow","page","canPreviousPage","canNextPage","pageOptions","gotoPage","nextPage","previousPage","state","pageIndex","useTable","initialState","pageSize","manualPagination","usePagination","useEffect","hover","responsive","style","minWidth","headerGroup","index","getHeaderGroupProps","headers","column","getHeaderProps","render","row","getRowProps","cells","cell","getCellProps","min","max","defaultValue","Number","width","align","disabled","pointerEvents","length","Loader","API_URL","axios","get","authHeader","response","catch","reason","message","getNasabah","updateNasabah","nasabah","put","ktp_id","group","createNasabah","post"],"mappings":"kGAAA,uFAyJeA,UAtIK,KAClB,MAAMC,EAAUC,eACTC,EAAWC,GAAgBC,sBAC3BC,EAAaC,GAAcF,mBAAS,KACpCG,EAAaC,GAAkBJ,mBAAS,KACxCK,EAAQC,GAAaN,mBAAS,KAC9BO,EAAWC,GAAgBR,mBAAS,GACrCS,EAAaC,iBAAO,GAEpBC,EAAYC,uBAChB,EAAGC,aACiBJ,EAAWK,UACbL,EAAWK,UACzBf,GAAa,GACbgB,YAAeF,EAAMV,EAAaE,GAAQW,MAAMC,IAAU,IAAD,EACvDC,QAAQC,IAAIF,GACZ,IAAIG,EAAQC,KAAKC,MAAML,EAAKM,WAAWC,MAAQP,EAAKM,WAAWE,OAC3DR,EAAKM,WAAWC,MAAQP,EAAKM,WAAWE,MAAQlB,IAClDa,GAAS,GAEXZ,EAAaY,GACblB,EAAU,UACRe,EAAKA,YADG,aACR,EAAWS,KAAKC,IACP,CACLC,KAAMD,EAAKC,KACXC,OAAQF,EAAKG,UACbC,SAAUJ,EAAKK,QACf3B,OAAQsB,EAAKM,OACX,cAAC,IAAD,CAAQC,UAAU,OAAOC,MAAM,UAAUC,MAAM,eAA/C,oBAIA,cAAC,IAAD,CAAQF,UAAU,OAAOC,MAAM,YAAYC,MAAM,eAAjD,sBAIFC,OACE,eAAC,IAAD,CACEF,MAAM,OACNG,KAAM,KACNC,QAAS,IAAM3C,EAAQ4C,KAAK,YAAcb,EAAKc,IAHjD,UAKE,cAAC,IAAD,CAAOC,KAAMC,IAAQT,UAAU,SALjC,eAYRnC,GAAa,SAKnB,CAACH,EAASO,EAAaE,IAGnBuC,EAAUC,IAAMC,SACpB,IAAM,CACJ,CACEC,OAAQ,OACRC,SAAU,QAEZ,CACED,OAAQ,kBACRC,SAAU,UAEZ,CACED,OAAQ,WACRC,SAAU,YAEZ,CACED,OAAQ,SACRC,SAAU,UAEZ,CACED,OAAQ,SACRC,SAAU,YAGd,IAGF,OACE,eAAC,IAAD,WACE,eAAC,IAAD,CAAMd,UAAU,qBAAhB,UACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAYe,QAAQ,cAApB,oBACA,cAAC,IAAD,CACEC,KAAK,OACLT,GAAG,cACHU,YAAY,uBACZC,SAAWC,IACTjD,EAAeiD,EAAEC,OAAOC,aAI9B,eAAC,IAAD,WACE,cAAC,IAAD,CAAYN,QAAQ,cAApB,oBACA,eAAC,IAAD,CACER,GAAG,cACHW,SAAWC,IACT/C,EAAU+C,EAAEC,OAAOC,QAHvB,UAME,wBAAQA,MAAM,GAAd,iBACA,wBAAQA,MAAM,QAAd,sBACA,wBAAQA,MAAM,OAAd,0BAGJ,cAAC,IAAD,CAAMrB,UAAW,6BAAjB,SACE,cAAC,IAAD,CAASC,MAAM,UAAUI,QAAS,IAAM3C,EAAQ4C,KAAK,mBAArD,0BAKJ,uBACA,cAAC,IAAD,UACE,cAAC,IAAD,UACE,cAAC,IAAD,UACE,cAAC,IAAD,CACEI,QAASA,EACT3B,KAAMhB,EACNuD,oBAAqBjD,EACrBI,UAAWA,EACXb,UAAWA,e,iCChJzB,8EAkBO,SAAS2D,GAAM,QAAEb,EAAF,KAAW3B,EAAX,oBAAiBuC,EAAjB,UAAsC7C,EAAtC,UAAiDb,IACrE,MAAM,cACJ4D,EADI,kBAEJC,EAFI,aAGJC,EAHI,WAIJC,EAJI,KAKJC,EALI,gBAMJC,EANI,YAOJC,EAPI,YAQJC,EARI,SASJC,EATI,SAUJC,EAVI,aAWJC,EACAC,OAAO,UAAEC,IACPC,mBACF,CACE3B,UACA3B,OACAuD,aAAc,CACZF,UAAW,EACXG,SAAU,IAEZC,kBAAkB,EAClBnE,UAAWiD,GAEbmB,iBAOF,OAJAC,qBAAU,KAERjE,GAAaA,EAAU,CAAEE,KADA,GAAZyD,MAEZ,CAAC3D,EAAW2D,IACRxE,EACL,qCACE,eAAC,KAAD,CAAQ+E,OAAK,EAACC,YAAU,EAACC,MAAO,CAAEC,SAAU,YAAetB,IAA3D,UACE,cAAC,KAAD,UACGE,EAAalC,KAAI,CAACuD,EAAaC,IAC9B,cAAC,KAAD,IAA2BD,EAAYE,sBAAvC,SACGF,EAAYG,QAAQ1D,KAAI,CAAC2D,EAAQH,IAChC,cAAC,KAAD,IAAkCG,EAAOC,iBAAzC,SACGD,EAAOE,OAAO,WADML,MAFXA,OASpB,cAAC,KAAD,IAAgBvB,IAAhB,SACGG,EAAKpC,KAAI,CAAC8D,EAAKN,KACdrB,EAAW2B,GAET,cAAC,KAAD,IAA2BA,EAAIC,cAA/B,SACGD,EAAIE,MAAMhE,KAAI,CAACiE,EAAMT,IAElB,cAAC,KAAD,IAAgCS,EAAKC,eAArC,SACGD,EAAKJ,OAAO,SADML,MAHXA,WAcxB,eAAC,IAAD,CAAYhD,UAAW,gDAAvB,UACE,cAAC,IAAD,CAAaA,UAAW,OAAxB,yBACA,cAAC,IAAD,CACE2D,IAAK,EACLC,IAAKtC,EACLN,KAAK,SACL6C,aAAczB,EAAY,EAC1BlB,SAAWC,IACT,MAAMS,EAAOT,EAAEC,OAAOC,MAAQyC,OAAO3C,EAAEC,OAAOC,OAAS,EAAI,EAC3DW,EAASJ,IAEXiB,MAAO,CAAEkB,MAAO,cAIpB,eAAC,IAAD,CAAaC,MAAM,SAAS,aAAW,kBAAvC,UACE,cAAC,IAAD,CAAiB,aAAW,QAAQ3D,QAAS,IAAM2B,EAAS,GAAIiC,UAAWpC,EAA3E,SACG,OAEH,cAAC,IAAD,CACE,aAAW,WACXxB,QAAS,IAAM6B,IACf+B,UAAWpC,EAHb,SAKG,MAEH,eAAC,IAAD,CAAiB,aAAW,UAAUgB,MAAO,CAAEqB,cAAe,QAA9D,kBACO,iCAAS9B,EAAY,IAD5B,OAC2C,iCAASL,EAAYoC,YAEhE,cAAC,IAAD,CAAiB,aAAW,OAAO9D,QAAS,IAAM4B,IAAYgC,UAAWnC,EAAzE,SACG,MAEH,cAAC,IAAD,CACE,aAAW,OACXzB,QAAS,IAAM2B,EAASV,EAAsB,GAC9C2C,UAAWnC,EAHb,SAKG,aAKPsC,gB,iCC5HJ,uKAGA,MAAMC,EAAU,2BAET,SAASxF,EAAeF,EAAMV,EAAaE,GAChD,OAAOmG,IACJC,IACCF,EAAU,2BAA6BpG,EAAc,WAAaE,EAAS,SAAWQ,EACtF,CACEuE,QAASsB,gBAGZ1F,MAAM2F,GACEA,EAAS1F,OAEjB2F,OAAOC,IACN,GAA+B,MAA3BA,EAAOF,SAAStG,OAElB,OADAa,QAAQC,IAAI0F,EAAOC,SACZ,QAKR,SAASC,EAAWtE,GACzB,OAAO+D,IACJC,IAAIF,EAAU,oBAAsB9D,EAAI,CAAE2C,QAASsB,gBACnD1F,MAAM2F,GACEA,EAAS1F,OAEjB2F,OAAOC,IACN,GAA+B,MAA3BA,EAAOF,SAAStG,OAElB,OADAa,QAAQC,IAAI0F,EAAOC,SACZ,QAKR,SAASE,EAAcvE,EAAIwE,GAChC,OAAOT,IACJU,IACCX,EAAU,oBAAsB9D,EAChC,CACEb,KAAMqF,EAAQrF,KACduF,OAAQF,EAAQE,OAChBrF,UAAWmF,EAAQnF,UACnBE,QAASiF,EAAQjF,QACjB6E,OAAQI,EAAQJ,OAChBO,MAAOH,EAAQG,MACfnF,OAA2B,SAAnBgF,EAAQhF,QAElB,CACEmD,QAASsB,gBAGZ1F,MAAM2F,GACEA,EAAS1F,OAEjB2F,OAAOC,GACCA,EAAOF,SAAS1F,OAItB,SAASoG,EAAcJ,GAC5B,OAAOT,IACJc,KAAKf,EAAU,mBAAoBU,EAAS,CAC3C7B,QAASsB,gBAEV1F,MAAM2F,GACEA,EAAS1F,OAEjB2F,OAAOC,GACCA,EAAOF,SAAS1F","file":"static/js/14.c8178160.chunk.js","sourcesContent":["import React, { useCallback, useRef, useState } from 'react'\nimport {\n  CBadge,\n  CButton,\n  CCard,\n  CCardBody,\n  CCol,\n  CContainer,\n  CFormInput,\n  CFormLabel,\n  CFormSelect,\n  CRow,\n} from '@coreui/react'\nimport { useHistory } from 'react-router-dom'\nimport { Table } from '../../../components/Table'\nimport { getNasabahList } from '../../../api/api_nasabah'\nimport { cilPen } from '@coreui/icons'\nimport CIcon from '@coreui/icons-react'\n\nconst NasabahList = () => {\n  const history = useHistory()\n  const [hasLoaded, setHasLoaded] = useState()\n  const [nasabahList, setNasabah] = useState([])\n  const [searchQuery, setSearchQuery] = useState('')\n  const [status, setStatus] = useState('')\n  const [pageCount, setPageCount] = useState(0)\n  const fetchIdRef = useRef(0)\n\n  const fetchData = useCallback(\n    ({ skip }) => {\n      const fetchId = ++fetchIdRef.current\n      if (fetchId === fetchIdRef.current) {\n        setHasLoaded(false)\n        getNasabahList(skip, searchQuery, status).then((data) => {\n          console.log(data)\n          let pages = Math.floor(data.pagination.total / data.pagination.limit)\n          if (data.pagination.total / data.pagination.limit > pageCount) {\n            pages += 1\n          }\n          setPageCount(pages)\n          setNasabah(\n            data.data?.map((item) => {\n              return {\n                name: item.name,\n                number: item.wa_number,\n                location: item.address,\n                status: item.active ? (\n                  <CBadge className=\"mt-1\" color=\"success\" shape=\"rounded-pill\">\n                    ACTIVE\n                  </CBadge>\n                ) : (\n                  <CBadge className=\"mt-1\" color=\"secondary\" shape=\"rounded-pill\">\n                    INACTIVE\n                  </CBadge>\n                ),\n                action: (\n                  <CButton\n                    color=\"dark\"\n                    size={'sm'}\n                    onClick={() => history.push('/nasabah/' + item.id)}\n                  >\n                    <CIcon icon={cilPen} className=\"me-1\" />\n                    Edit\n                  </CButton>\n                ),\n              }\n            }),\n          )\n          setHasLoaded(true)\n        })\n      }\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [history, searchQuery, status],\n  )\n\n  const columns = React.useMemo(\n    () => [\n      {\n        Header: 'Name',\n        accessor: 'name',\n      },\n      {\n        Header: 'WhatsApp Number',\n        accessor: 'number',\n      },\n      {\n        Header: 'Location',\n        accessor: 'location',\n      },\n      {\n        Header: 'Status',\n        accessor: 'status',\n      },\n      {\n        Header: 'Action',\n        accessor: 'action',\n      },\n    ],\n    [],\n  )\n\n  return (\n    <CContainer>\n      <CRow className=\"align-items-center\">\n        <CCol>\n          <CFormLabel htmlFor=\"searchInput\">Search</CFormLabel>\n          <CFormInput\n            type=\"text\"\n            id=\"searchInput\"\n            placeholder=\"Enter search query..\"\n            onChange={(e) => {\n              setSearchQuery(e.target.value)\n            }}\n          />\n        </CCol>\n        <CCol>\n          <CFormLabel htmlFor=\"statusInput\">Status</CFormLabel>\n          <CFormSelect\n            id=\"statusInput\"\n            onChange={(e) => {\n              setStatus(e.target.value)\n            }}\n          >\n            <option value=\"\">All</option>\n            <option value=\"false\">Inactive</option>\n            <option value=\"true\">Active</option>\n          </CFormSelect>\n        </CCol>\n        <CCol className={'d-flex justify-content-end'}>\n          <CButton color=\"primary\" onClick={() => history.push('/nasabah/create')}>\n            Add New\n          </CButton>\n        </CCol>\n      </CRow>\n      <br />\n      <CRow>\n        <CCard>\n          <CCardBody>\n            <Table\n              columns={columns}\n              data={nasabahList}\n              controlledPageCount={pageCount}\n              fetchData={fetchData}\n              hasLoaded={hasLoaded}\n            />\n          </CCardBody>\n        </CCard>\n      </CRow>\n    </CContainer>\n  )\n}\n\nexport default NasabahList\n","import { usePagination, useTable } from 'react-table'\nimport {\n  CContainer,\n  CFormInput,\n  CHeaderText,\n  CPagination,\n  CPaginationItem,\n  CTable,\n  CTableBody,\n  CTableDataCell,\n  CTableHead,\n  CTableHeaderCell,\n  CTableRow,\n} from '@coreui/react'\nimport React, { useEffect } from 'react'\nimport Loader from './Loader'\n\n// eslint-disable-next-line react/prop-types\nexport function Table({ columns, data, controlledPageCount, fetchData, hasLoaded }) {\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    prepareRow,\n    page,\n    canPreviousPage,\n    canNextPage,\n    pageOptions,\n    gotoPage,\n    nextPage,\n    previousPage,\n    state: { pageIndex },\n  } = useTable(\n    {\n      columns,\n      data,\n      initialState: {\n        pageIndex: 0,\n        pageSize: 10,\n      },\n      manualPagination: true,\n      pageCount: controlledPageCount,\n    },\n    usePagination,\n  )\n\n  useEffect(() => {\n    const skip = pageIndex * 10\n    fetchData && fetchData({ skip })\n  }, [fetchData, pageIndex])\n  return hasLoaded ? (\n    <>\n      <CTable hover responsive style={{ minWidth: '45rem' }} {...getTableProps()}>\n        <CTableHead>\n          {headerGroups.map((headerGroup, index) => (\n            <CTableRow key={index} {...headerGroup.getHeaderGroupProps()}>\n              {headerGroup.headers.map((column, index) => (\n                <CTableHeaderCell key={index} {...column.getHeaderProps()}>\n                  {column.render('Header')}\n                </CTableHeaderCell>\n              ))}\n            </CTableRow>\n          ))}\n        </CTableHead>\n        <CTableBody {...getTableBodyProps()}>\n          {page.map((row, index) => {\n            prepareRow(row)\n            return (\n              <CTableRow key={index} {...row.getRowProps()}>\n                {row.cells.map((cell, index) => {\n                  return (\n                    <CTableDataCell key={index} {...cell.getCellProps()}>\n                      {cell.render('Cell')}\n                    </CTableDataCell>\n                  )\n                })}\n              </CTableRow>\n            )\n          })}\n        </CTableBody>\n      </CTable>\n\n      <CContainer className={'d-flex justify-content-end align-items-center'}>\n        <CHeaderText className={'pe-2'}>Go to page:</CHeaderText>\n        <CFormInput\n          min={1}\n          max={controlledPageCount}\n          type=\"number\"\n          defaultValue={pageIndex + 1}\n          onChange={(e) => {\n            const page = e.target.value ? Number(e.target.value) - 1 : 0\n            gotoPage(page)\n          }}\n          style={{ width: '100px' }}\n        />\n      </CContainer>\n\n      <CPagination align=\"center\" aria-label=\"Page navigation\">\n        <CPaginationItem aria-label=\"First\" onClick={() => gotoPage(0)} disabled={!canPreviousPage}>\n          {'<<'}\n        </CPaginationItem>\n        <CPaginationItem\n          aria-label=\"Previous\"\n          onClick={() => previousPage()}\n          disabled={!canPreviousPage}\n        >\n          {'<'}\n        </CPaginationItem>\n        <CPaginationItem aria-label=\"Current\" style={{ pointerEvents: 'none' }}>\n          Page <strong>{pageIndex + 1}</strong> of <strong>{pageOptions.length}</strong>\n        </CPaginationItem>\n        <CPaginationItem aria-label=\"Next\" onClick={() => nextPage()} disabled={!canNextPage}>\n          {'>'}\n        </CPaginationItem>\n        <CPaginationItem\n          aria-label=\"Last\"\n          onClick={() => gotoPage(controlledPageCount - 1)}\n          disabled={!canNextPage}\n        >\n          {'>>'}\n        </CPaginationItem>\n      </CPagination>\n    </>\n  ) : (\n    Loader()\n  )\n}\n","import axios from 'axios'\nimport { authHeader } from './requestHeaders'\n\nconst API_URL = 'https://api.ekoop.id/v01'\n\nexport function getNasabahList(skip, searchQuery, status) {\n  return axios\n    .get(\n      API_URL + '/nasabah/nasabah?search=' + searchQuery + '&status=' + status + '&skip=' + skip,\n      {\n        headers: authHeader(),\n      },\n    )\n    .then((response) => {\n      return response.data\n    })\n    .catch((reason) => {\n      if (reason.response.status === 403) {\n        console.log(reason.message)\n        return null\n      }\n    })\n}\n\nexport function getNasabah(id) {\n  return axios\n    .get(API_URL + '/nasabah/nasabah/' + id, { headers: authHeader() })\n    .then((response) => {\n      return response.data\n    })\n    .catch((reason) => {\n      if (reason.response.status === 403) {\n        console.log(reason.message)\n        return null\n      }\n    })\n}\n\nexport function updateNasabah(id, nasabah) {\n  return axios\n    .put(\n      API_URL + '/nasabah/nasabah/' + id,\n      {\n        name: nasabah.name,\n        ktp_id: nasabah.ktp_id,\n        wa_number: nasabah.wa_number,\n        address: nasabah.address,\n        reason: nasabah.reason,\n        group: nasabah.group,\n        active: nasabah.active === 'true',\n      },\n      {\n        headers: authHeader(),\n      },\n    )\n    .then((response) => {\n      return response.data\n    })\n    .catch((reason) => {\n      return reason.response.data\n    })\n}\n\nexport function createNasabah(nasabah) {\n  return axios\n    .post(API_URL + '/nasabah/nasabah', nasabah, {\n      headers: authHeader(),\n    })\n    .then((response) => {\n      return response.data\n    })\n    .catch((reason) => {\n      return reason.response.data\n    })\n}\n"],"sourceRoot":""}