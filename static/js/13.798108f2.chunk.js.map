{"version":3,"sources":["views/notifications/notification_list/Notifications.js","helpers/notification_types.js","api/api_notification.js","../node_modules/@coreui/icons/js/free/cil-sad.js","components/Table.js"],"names":["Notifications","history","useHistory","notifications","setNotifications","useState","pageCount","setPageCount","hasLoaded","setHasLoaded","fetchIdRef","useRef","fetchData","useCallback","skip","current","getNotifications","then","data","ok","console","log","pages","Math","floor","pagination","total","limit","map","item","created","sender","title","content","action","color","size","onClick","push","id","columns","React","useMemo","Header","accessor","fluid","className","xl","value","controlledPageCount","Services","changePassword","clientRegister","clientApprove","clientReject","userCreate","userEdit","nasabahCreate","nasabahEdit","profileEdit","packageCreate","packageEdit","productCreate","productEdit","ppobAllMarginEdit","ppobEdit","Titles","Contents","API_URL","axios","get","headers","authHeader","response","catch","reason","status","message","getNotification","createNotification","service","extra","notification","reference_id","post","cilSad","Table","getTableProps","getTableBodyProps","headerGroups","prepareRow","page","canPreviousPage","canNextPage","pageOptions","gotoPage","nextPage","previousPage","state","pageIndex","useTable","initialState","pageSize","manualPagination","usePagination","useEffect","length","hover","responsive","style","minWidth","headerGroup","index","getHeaderGroupProps","column","getHeaderProps","render","row","getRowProps","cells","cell","getCellProps","min","max","type","defaultValue","onChange","e","target","Number","width","align","disabled","pointerEvents","icon"],"mappings":"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","file":"static/js/13.798108f2.chunk.js","sourcesContent":["import React, { useCallback, useRef, useState } from 'react'\nimport {\n  CButton,\n  CCard,\n  CCardBody,\n  CCol,\n  CContainer,\n  CFormInput,\n  CFormSelect,\n  CRow,\n} from '@coreui/react'\nimport { getNotifications } from '../../../api/api_notification'\nimport { Table } from '../../../components/Table'\nimport { useHistory } from 'react-router-dom'\n\nconst Notifications = () => {\n  const history = useHistory()\n  const [notifications, setNotifications] = useState([])\n  const [pageCount, setPageCount] = useState(0)\n  const [hasLoaded, setHasLoaded] = useState(false)\n  const fetchIdRef = useRef(0)\n\n  const fetchData = useCallback(({ skip }) => {\n    const fetchId = ++fetchIdRef.current\n    if (fetchId === fetchIdRef.current) {\n      setHasLoaded(false)\n      getNotifications(skip).then((data) => {\n        if (data.ok) {\n          console.log(data)\n          let pages = Math.floor(data.pagination.total / data.pagination.limit)\n          if (data.pagination.total / data.pagination.limit > pageCount) {\n            pages += 1\n          }\n          setPageCount(pages)\n          setNotifications(\n            data.data?.map((item) => {\n              return {\n                created: item.created,\n                sender: item.sender,\n                title: item.title,\n                content: item.content,\n                action: (\n                  <CButton\n                    color=\"dark\"\n                    size={'sm'}\n                    onClick={() => history.push('/notifications/' + item.id)}\n                  >\n                    View\n                  </CButton>\n                ),\n              }\n            }),\n          )\n          setHasLoaded(true)\n        }\n      })\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  const columns = React.useMemo(\n    () => [\n      {\n        Header: 'Date',\n        accessor: 'created',\n      },\n      {\n        Header: 'Sender',\n        accessor: 'sender',\n      },\n      {\n        Header: 'Title',\n        accessor: 'title',\n      },\n      {\n        Header: 'Content',\n        accessor: 'content',\n      },\n      {\n        Header: 'Action',\n        accessor: 'action',\n      },\n    ],\n    [],\n  )\n\n  return (\n    <CContainer fluid>\n      <CRow className=\"align-items-center\">\n        <CCol xl={1}>Search</CCol>\n        <CCol>\n          <CFormInput></CFormInput>\n        </CCol>\n        <CCol>\n          <CFormSelect>\n            <option value=\"1\">One</option>\n            <option value=\"2\">Two</option>\n            <option value=\"3\">Three</option>\n          </CFormSelect>\n        </CCol>\n      </CRow>\n      <br />\n      <CRow>\n        <CCard>\n          <CCardBody>\n            <Table\n              columns={columns}\n              data={notifications}\n              controlledPageCount={pageCount}\n              fetchData={fetchData}\n              hasLoaded={hasLoaded}\n            />\n          </CCardBody>\n        </CCard>\n      </CRow>\n    </CContainer>\n  )\n}\n\nexport default Notifications\n","export const Services = {\n  changePassword: 'change-password',\n  clientRegister: 'client-register',\n  clientApprove: 'client-approve',\n  clientReject: 'client-reject',\n  userCreate: 'user-create',\n  userEdit: 'user-edit',\n  nasabahCreate: 'nasabah-create',\n  nasabahEdit: 'nasabah-edit',\n  profileEdit: 'profile-edit',\n  packageCreate: 'package-create',\n  packageEdit: 'package-edit',\n  productCreate: 'product-create',\n  productEdit: 'product-edit',\n  ppobAllMarginEdit: 'ppob-all-margin-edit',\n  ppobEdit: 'ppob-edit',\n}\n\nexport const Titles = {\n  'change-password': 'Password changed',\n  'client-register': 'New client registered',\n  'client-approve': 'Request approved',\n  'client-reject': 'Request rejected',\n  'user-create': 'New user created',\n  'user-edit': 'User updated',\n  'nasabah-create': 'New nasabah created',\n  'nasabah-edit': 'Nasabah updated',\n  'profile-edit': 'Profile updated',\n  'package-create': 'New package created',\n  'package-edit': 'Package updated',\n  'product-create': 'New product created',\n  'product-edit': 'Product updated',\n  'ppob-all-margin-edit': 'All services margin updated',\n  'ppob-edit': 'PPOB updated',\n}\n\nexport const Contents = {\n  'change-password': \"User's password changed\",\n  'client-register': 'New client registration request created',\n  'client-approve': 'Client registration request approved',\n  'client-reject': 'Client registration request rejected',\n  'user-create': 'New user created: ',\n  'user-edit': 'User`s info edited: ',\n  'nasabah-create': 'New nasabah created: ',\n  'nasabah-edit': 'Nasabah`s info updated: ',\n  'profile-edit': 'Profile`s info updated',\n  'package-create': 'New package created: ',\n  'package-edit': 'Package`s info updated: ',\n  'product-create': 'New product created: ',\n  'product-edit': 'Product`s info updated: ',\n  'ppob-all-margin-edit': 'All services margin updated',\n  'ppob-edit': 'PPOB`s info updated: ',\n}\n","import axios from 'axios'\nimport { authHeader } from './requestHeaders'\nimport { Contents, Titles } from '../helpers/notification_types'\n\nconst API_URL = 'https://api.ekoop.id/v01'\n\nexport function getNotifications(skip) {\n  return axios\n    .get(API_URL + '/users/notification?skip=' + skip, { headers: authHeader() })\n    .then((response) => {\n      return response.data\n    })\n    .catch((reason) => {\n      if (reason.response.status === 403) {\n        console.log(reason.message)\n        return null\n      }\n    })\n}\n\nexport function getNotification(id) {\n  return axios\n    .get(API_URL + '/users/notification/' + id, { headers: authHeader() })\n    .then((response) => {\n      return response.data\n    })\n    .catch((reason) => {\n      if (reason.response.status === 403) {\n        console.log(reason.message)\n        return null\n      }\n    })\n}\n\nexport function createNotification(sender, service, extra) {\n  const notification = {\n    sender: sender,\n    service: service,\n    title: Titles[service],\n    content: Contents[service] + extra,\n    reference_id: '',\n  }\n\n  return axios\n    .post(API_URL + '/users/notification', notification, {\n      headers: authHeader(),\n    })\n    .then((response) => {\n      return response.data\n    })\n    .catch((reason) => {\n      console.log(reason.response.data)\n    })\n}\n","export const cilSad = [\"512 512\",\"<path fill='var(--ci-primary-color, currentColor)' d='M256,16C123.452,16,16,123.452,16,256S123.452,496,256,496,496,388.548,496,256,388.548,16,256,16ZM403.078,403.078a207.253,207.253,0,1,1,44.589-66.125A207.332,207.332,0,0,1,403.078,403.078Z' class='ci-primary'/><rect width='40' height='40' x='152' y='200' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='40' height='40' x='320' y='200' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M256,288a88.1,88.1,0,0,0-88,88h32a56,56,0,0,1,112,0h32A88.1,88.1,0,0,0,256,288Z' class='ci-primary'/>\"]","import { usePagination, useTable } from 'react-table'\nimport {\n  CCol,\n  CContainer,\n  CFormInput,\n  CHeaderText,\n  CPagination,\n  CPaginationItem,\n  CSpinner,\n  CTable,\n  CTableBody,\n  CTableDataCell,\n  CTableHead,\n  CTableHeaderCell,\n  CTableRow,\n} from '@coreui/react'\nimport React, { useEffect } from 'react'\nimport CIcon from '@coreui/icons-react'\nimport { cilSad } from '@coreui/icons'\n\n// eslint-disable-next-line react/prop-types\nexport function Table({ columns, data, controlledPageCount, fetchData, hasLoaded }) {\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    prepareRow,\n    page,\n    canPreviousPage,\n    canNextPage,\n    pageOptions,\n    gotoPage,\n    nextPage,\n    previousPage,\n    state: { pageIndex },\n  } = useTable(\n    {\n      columns,\n      data,\n      initialState: {\n        pageIndex: 0,\n        pageSize: 10,\n      },\n      manualPagination: true,\n      pageCount: controlledPageCount,\n    },\n    usePagination,\n  )\n\n  useEffect(() => {\n    const skip = pageIndex * 10\n    fetchData && fetchData({ skip })\n  }, [fetchData, pageIndex])\n  return hasLoaded ? (\n    page.length > 0 ? (\n      <>\n        <CTable hover responsive style={{ minWidth: '45rem' }} {...getTableProps()}>\n          <CTableHead>\n            {headerGroups.map((headerGroup, index) => (\n              <CTableRow key={index} {...headerGroup.getHeaderGroupProps()}>\n                {headerGroup.headers.map((column, index) => (\n                  <CTableHeaderCell key={index} {...column.getHeaderProps()}>\n                    {column.render('Header')}\n                  </CTableHeaderCell>\n                ))}\n              </CTableRow>\n            ))}\n          </CTableHead>\n          <CTableBody {...getTableBodyProps()}>\n            {page.map((row, index) => {\n              prepareRow(row)\n              return (\n                <CTableRow key={index} {...row.getRowProps()}>\n                  {row.cells.map((cell, index) => {\n                    return (\n                      <CTableDataCell key={index} {...cell.getCellProps()}>\n                        {cell.render('Cell')}\n                      </CTableDataCell>\n                    )\n                  })}\n                </CTableRow>\n              )\n            })}\n          </CTableBody>\n        </CTable>\n\n        <CContainer className={'d-flex justify-content-end align-items-center'}>\n          <CHeaderText className={'pe-2'}>Go to page:</CHeaderText>\n          <CFormInput\n            min={1}\n            max={controlledPageCount}\n            type=\"number\"\n            defaultValue={pageIndex + 1}\n            onChange={(e) => {\n              const page = e.target.value ? Number(e.target.value) - 1 : 0\n              gotoPage(page)\n            }}\n            style={{ width: '100px' }}\n          />\n        </CContainer>\n\n        <CPagination align=\"center\" aria-label=\"Page navigation\">\n          <CPaginationItem\n            aria-label=\"First\"\n            onClick={() => gotoPage(0)}\n            disabled={!canPreviousPage}\n          >\n            {'<<'}\n          </CPaginationItem>\n          <CPaginationItem\n            aria-label=\"Previous\"\n            onClick={() => previousPage()}\n            disabled={!canPreviousPage}\n          >\n            {'<'}\n          </CPaginationItem>\n          <CPaginationItem aria-label=\"Current\" style={{ pointerEvents: 'none' }}>\n            Page <strong>{pageIndex + 1}</strong> of <strong>{pageOptions.length}</strong>\n          </CPaginationItem>\n          <CPaginationItem aria-label=\"Next\" onClick={() => nextPage()} disabled={!canNextPage}>\n            {'>'}\n          </CPaginationItem>\n          <CPaginationItem\n            aria-label=\"Last\"\n            onClick={() => gotoPage(controlledPageCount - 1)}\n            disabled={!canNextPage}\n          >\n            {'>>'}\n          </CPaginationItem>\n        </CPagination>\n      </>\n    ) : (\n      <CCol className=\"d-flex justify-content-center\">\n        <CHeaderText>\n          Nothing there <CIcon icon={cilSad} />{' '}\n        </CHeaderText>\n      </CCol>\n    )\n  ) : (\n    <CCol className=\"d-flex justify-content-center\">\n      <CSpinner color=\"primary\" />\n    </CCol>\n  )\n}\n"],"sourceRoot":""}